@model Project.Models.CProductWrap

@{
    Layout = "~/Views/Shared/Front_Layout.cshtml";
}
@section Styles {
    <link href="https://fonts.googleapis.com/css2?family=Cactus+Classical+Serif&family=LXGW+WenKai+TC&family=Liu+Jian+Mao+Cao&family=Long+Cang&family=Ma+Shan+Zheng&family=ZCOOL+QingKe+HuangYou&display=swap" rel="stylesheet">
    <style>
        .btn-side {
            position: absolute;
            margin: 2px;
            background-color: #8891a3c7 !important;
            border: none !important;
            color: white !important;
            width: 60px;
            height: 35px;
            border-radius: 10px !important;
        }

            .btn-side:hover {
                background-color: #8a8282c7 !important;
                border: 1px solid #8891a3c7 !important;
            }

        .product-item {
            text-align: center;
        }


        .sticky-sidebar {
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto; /* 確保如果內容過長，仍可在內部滾動 */
        }

            .sticky-sidebar::-webkit-scrollbar {
                display: none;
            }

        .product-images img {
            width: 100%;
            height: auto;
            object-fit: cover;
            margin: 0;
            padding: 0;
        }

        .product-images .col-6 {
            padding: 0; /* 移除 Bootstrap 預設間距 */
        }
    </style>
}
<!-- breadcrumb 麵包屑 -->
<nav aria-label="breadcrumb" class="p-3">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="~/FrontHome/FrontIndex" class="text-decoration-none">首頁</a></li>
        <li class="breadcrumb-item active" aria-current="page"><a href="~/Product/ProductList" class="text-decoration-none">商品列表</a></li>
        <li class="breadcrumb-item active" aria-current="page">商品介紹</li>
    </ol>
</nav>
<div class="container">
    <div class="row">
        <!-- 左側圖片區-->
        <div class="col-md-8">
            <div class="row product-images">
                <div class="col-6">
                    <img src="~/Images/@Html.DisplayFor(model => model.Pphoto)" alt="">
                </div>
                @{
                    int count = 0;
                    @foreach (var image in Model.Images)
                    {
                        count++;
                        <div class="col-6">
                            <img src="~/Images/@image" alt="商品圖片">
                        </div>
                    }
                }
            </div>
        </div>

        <!-- 右側固定欄 -->
        <div class="col-md-4 sticky-sidebar p-3 ">
            <div class="fs-3 ms-4"> @Html.DisplayFor(model => model.Pname) </div>
            <div class="fs-3 mt-5 ms-4">NT$ @Html.DisplayFor(model => model.Pprice) </div>
            <div class="fs-5 mt-5 ms-4">@Html.DisplayFor(model => model.Pdescription) </div>
            <div class="fs-5 mt-5 ms-4">@Html.DisplayFor(model => model.Pcolor) </div>
            <div class="fs-5 ms-4">
                <div class="my-5">
                    <button type="button" class="btn btn-outline-dark" value="S">S</button>
                    <button type="button" class="btn btn-outline-dark" value="M">M</button>
                    <button type="button" class="btn btn-outline-dark" value="L">L</button>
                    <button type="button" class="btn btn-outline-dark" value="XL">XL</button>
                </div>
                <div class="fs-5 mt-4">
                    <div class="input-group" style="max-width: 150px;">
                        <button class="btn btn-outline-secondary" type="button" onclick="decreaseQuantity()">-</button>
                        <input type="text" class="form-control text-center" value="1" id="quantity">
                        <button class="btn btn-outline-secondary" type="button" onclick="increaseQuantity()">+</button>
                    </div>
                    <button type="button" class="btn btn-outline-secondary mt-2"
                            onclick="addToCart('@Model.Pid', '@Model.Pname', '@Model.Pphoto', '@Model.Pprice')">
                        加入購物車
                    </button>

                    <button type="button" class="btn btn-outline-secondary mt-2"
                            onclick="addToFavorite('@Model.Pid', '@Model.Pname', '@Model.Pphoto', '@Model.Pprice')">
                        加入最愛
                    </button>

                </div>
            </div>
            <div class="card mt-5">
                <div class="card-body">
                    <h5 class="card-title">
                        <span class="fw-bold">會員</span>
                        <span class="text-warning">★★★★★</span>
                    </h5>
                    <p class="text-muted">2024-06-17 20:13</p>
                    <p class="card-text">
                        超好看的
                    </p>
                    <div class="d-flex mt-6">
                        <img src="~/Images/pc-01-06.jpg" class="img-thumbnail me-2" width="120">
                        <img src="~/Images/pc-01-07.jpg" class="img-thumbnail" width="120">
                    </div>
                </div>
            </div>

            <div class="card mt-3 bg-light">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">賣家回應</h6>
                    <p class="card-text">
                        感謝你的購買
                    </p>
                </div>
            </div>
            <div class="card mt-5">
                <div class="card-body">
                    <h5 class="card-title">
                        <span class="fw-bold">會員</span>
                        <span class="text-warning">★★★★★</span>
                    </h5>
                    <p class="text-muted">2024-06-17 20:13</p>
                    <p class="card-text">
                        超好看的
                    </p>
                    <div class="d-flex mt-6">
                        <img src="~/Images/pc-01-04.jpg" class="img-thumbnail me-2" width="120">
                        <img src="~/Images/pc-01-05.jpg" class="img-thumbnail" width="120">
                    </div>
                </div>
            </div>
            <div class="card mt-3 bg-light">
                <div class="card-body">
                    <h6 class="card-subtitle mb-2 text-muted">賣家回應</h6>
                    <p class="card-text">
                        感謝你的購買
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>


@section Scripts
{
    <script>
        function increaseQuantity() {
          var quantity = document.getElementById("quantity");
          quantity.value = parseInt(quantity.value) + 1;
        }

        function decreaseQuantity() {
          var quantity = document.getElementById("quantity");
          if (parseInt(quantity.value) > 1) {
            quantity.value = parseInt(quantity.value) - 1;
          }
        }

        function addToCart(productId, productName, productPhoto, productPrice) {
            var quantity = parseInt(document.getElementById("quantity").value); // 取得目前輸入的數量
            $.ajax({
                url: '/AJAX/SaveToCart', // 確保此路徑正確
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    PId: productId,
                    PName: productName,
                    PPhoto: productPhoto,
                    PPrice: productPrice,
                    Quantity: quantity // 使用者選擇的數量
                }),
                success: function(response) {
                    alert(response); // 顯示伺服器回傳的訊息
                },
                error: function(xhr, status, error) {
                    console.error("加入購物車時發生錯誤: " + error);
                    alert("加入購物車失敗，請稍後再試！");
                }
            });
        }
         function addToFavorite(productId, productName, productPhoto, productPrice) {
            $.ajax({
                url: '/AJAX/PostFavorite',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    PId: productId,
                    PName: productName,
                    PPhoto: productPhoto,
                    PPrice: productPrice
                }),
                success: function(response) {
                    alert(response);
                },
                error: function(xhr, status, error) {
                    alert(err);
                }
            });
        }
    </script>
}

